<!DOCTYPE html>
<html lang="ko-KR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width" />
  <script
    type="application/javascript"
    src='https://pink-spider.github.io/js/theme-mode.js'
  ></script>
  <link rel="stylesheet" href='https://pink-spider.github.io/css/frameworks.min.css' />
  <link rel="stylesheet" href='https://pink-spider.github.io/css/github.min.css' />
  <link rel="stylesheet" href='https://pink-spider.github.io/css/github-style.css' />
  <link rel="stylesheet" href='https://pink-spider.github.io/css/light.css' />
  <link rel="stylesheet" href='https://pink-spider.github.io/css/dark.css' />
  <link rel="stylesheet" href='https://pink-spider.github.io/css/syntax.css' />
  
  <link rel="stylesheet" href="/your%20css%20file%20name" />
  
  <title>
    멱등성(Idempotence)에 대하여 | Pink Spider
  </title>
  
  <link rel="icon" type="image/x-icon" href="/images/logo_pinkspider.png" />
  
  <meta name="theme-color" content="#1e2327" />

  
  <meta
  name="description"
  content="멱등성(Idempotence)은 컴퓨터 과학에서 자주 등장하는 중요한 개념입니다. 아래에 일반적인 의미와 API 개발과의 관련성을 나누어 자세히 설명드리겠습니다.
💡 멱등성(Idempotence)이란? 멱등성이란 동일한 연산을 여러 번 수행해도 결과가 같아지는 성질을 말합니다. 수학에서 출발한 개념인데, 예를 들어 함수 f(x)가 있을 때 다음이 성립하면 멱등함수라고 합니다:
f(f(x)) = f(x) 예시 (수학적 관점) 절댓값 함수: | |x|| = |x| 집합의 합집합 연산: A ∪ A = A 🌐 멱등성과 API 개발 웹 API 설계 시, 멱등성은 안정적이고 예측 가능한 API를 만들기 위해 매우 중요한 성질입니다. 특히 REST API에서는 각 HTTP 메서드가 멱등성을 가질지를 설계 시 명확히 고려해야 합니다.
"
/>
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://pink-spider.github.io/post/til/idempotence/" />


<meta name="twitter:card" content="summary" />
<meta
  name="twitter:title"
  content="멱등성(Idempotence)에 대하여 - Pink Spider"
/>
<meta
  name="twitter:description"
  content="멱등성(Idempotence)은 컴퓨터 과학에서 자주 등장하는 중요한 개념입니다. 아래에 일반적인 의미와 API 개발과의 관련성을 나누어 자세히 설명드리겠습니다.
💡 멱등성(Idempotence)이란? 멱등성이란 동일한 연산을 여러 번 수행해도 결과가 같아지는 성질을 말합니다. 수학에서 출발한 개념인데, 예를 들어 함수 f(x)가 있을 때 다음이 성립하면 멱등함수라고 합니다:
f(f(x)) = f(x) 예시 (수학적 관점) 절댓값 함수: | |x|| = |x| 집합의 합집합 연산: A ∪ A = A 🌐 멱등성과 API 개발 웹 API 설계 시, 멱등성은 안정적이고 예측 가능한 API를 만들기 위해 매우 중요한 성질입니다. 특히 REST API에서는 각 HTTP 메서드가 멱등성을 가질지를 설계 시 명확히 고려해야 합니다.
"
/>
<meta name="twitter:site" content="https://pink-spider.github.io/" />
<meta name="twitter:creator" content="" />
<meta
  name="twitter:image"
  content="https://pink-spider.github.io/"
/>


<meta
  property="og:type"
  content="article"
/>
<meta
  property="og:title"
  content="멱등성(Idempotence)에 대하여 - Pink Spider"
/>
<meta
  property="og:description"
  content="멱등성(Idempotence)은 컴퓨터 과학에서 자주 등장하는 중요한 개념입니다. 아래에 일반적인 의미와 API 개발과의 관련성을 나누어 자세히 설명드리겠습니다.
💡 멱등성(Idempotence)이란? 멱등성이란 동일한 연산을 여러 번 수행해도 결과가 같아지는 성질을 말합니다. 수학에서 출발한 개념인데, 예를 들어 함수 f(x)가 있을 때 다음이 성립하면 멱등함수라고 합니다:
f(f(x)) = f(x) 예시 (수학적 관점) 절댓값 함수: | |x|| = |x| 집합의 합집합 연산: A ∪ A = A 🌐 멱등성과 API 개발 웹 API 설계 시, 멱등성은 안정적이고 예측 가능한 API를 만들기 위해 매우 중요한 성질입니다. 특히 REST API에서는 각 HTTP 메서드가 멱등성을 가질지를 설계 시 명확히 고려해야 합니다.
"
/>
<meta property="og:url" content="https://pink-spider.github.io/post/til/idempotence/" />
<meta property="og:site_name" content="멱등성(Idempotence)에 대하여" />
<meta
  property="og:image"
  content="https://pink-spider.github.io/"
/>
<meta property="og:image:width" content="2048" />
<meta property="og:image:height" content="1024" />

<meta property="article:published_time" content="2025-05-26 20:20:45 &#43;0900 KST" />















</head>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6329038356545416"
        crossorigin="anonymous"></script>

<body>
  

<style>
  .height-limitation {
    max-height: 300px;
    overflow-y: scroll;
  }

  .loader {
    border: 4px solid #f3f3f3;
    border-bottom: 4px solid var(--color-fg-muted);
    border-radius: 50%;
    width: 30px;
    height: 30px;
    animation: spin 1s linear infinite;
    margin: 0 auto;
  }

  @keyframes spin {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }
</style>

<div style="position: relative">
  <header
    class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on"
  >
    <div
      class="Header-item mobile-none"
      style="margin-top: -4px; margin-bottom: -4px"
    >
      <a class="Header-link" href="https://pink-spider.github.io/" aria-label="Home">
        <svg
          class="octicon"
          height="32"
          viewBox="0 0 16 16"
          version="1.1"
          width="32"
        >
          <path
            fill-rule="evenodd"
            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"
          ></path>
        </svg>
      </a>
    </div>
    <div class="Header-item d-md-none">
      <button
        class="Header-link btn-link js-details-target"
        type="button"
        onclick="document.querySelector('#header-search').style.display = document.querySelector('#header-search').style.display == 'none'? 'block': 'none'"
        aria-label="Search"
      >
        <svg
          height="24"
          class="octicon octicon-three-bars"
          viewBox="0 0 16 16"
          version="1.1"
          width="24"
        >
          <path
            fill-rule="evenodd"
            d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z"
          ></path>
        </svg>
      </button>
    </div>
    <div
      style="display: none"
      id="header-search"
      class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex"
    >
      <div
        class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to"
      >
        <div class="position-relative">
          <form
            target="_blank"
            action="https://www.google.com/search"
            accept-charset="UTF-8"
            method="get"
            autocomplete="off"
          >
            <label
              class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center"
            >
              <input
                type="text"
                class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable"
                name="q"
                value=""
                placeholder="Search"
                autocomplete="off"
              />
              <input type="hidden" name="q" value="site:https://pink-spider.github.io/" />
              <div
                class="js-jump-to-suggestions-container jump-to-suggestions overflow-hidden position-absolute"
              >
                <div
                  id="search-progress"
                  class="d-none color-bg-primary no-underline p-2"
                  role="progress"
                  aria-selected="false"
                >
                  <div class="loader"></div>
                </div>

                <ul
                  id="jump-to-results"
                  role="listbox"
                  class="Box border-0 p-0 m-0 js-navigation-container jump-to-suggestions-results-container js-jump-to-suggestions-results-container js-active-navigation-container height-limitation"
                ></ul>
              </div>
            </label>
          </form>
        </div>
      </div>
    </div>

    <div
      class="Header-item Header-item--full flex-justify-center d-md-none position-relative"
    >
      <a class="Header-link" href="https://pink-spider.github.io/" aria-label="Home">
        <svg
          class="octicon octicon-mark-github v-align-middle"
          height="32"
          viewBox="0 0 16 16"
          version="1.1"
          width="32"
        >
          <path
            fill-rule="evenodd"
            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"
          ></path>
        </svg>
      </a>
    </div>
    <div class="Theme-switcher Header-item" style="margin-right: 0">
      <span
        role="button"
        class="Header-link no-select"
        onclick="switchTheme()"
        style="cursor: pointer"
        aria-label="Switch theme"
      >
        <svg
          style="fill: var(--color-profile-color-modes-toggle-moon)"
          class="no-select"
          viewBox="0 0 16 16"
          version="1.1"
          width="16"
          height="16"
        >
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M4.52208 7.71754C7.5782 7.71754 10.0557 5.24006 10.0557 2.18394C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961C9.95801 1.07727 10.3495 0.771159 10.6474 0.99992C12.1153 2.12716 13.0615 3.89999 13.0615 5.89383C13.0615 9.29958 10.3006 12.0605 6.89485 12.0605C3.95334 12.0605 1.49286 10.001 0.876728 7.24527C0.794841 6.87902 1.23668 6.65289 1.55321 6.85451C2.41106 7.40095 3.4296 7.71754 4.52208 7.71754Z"
          ></path>
        </svg>
      </span>
    </div>
  </header>
</div>

  
<div>
  <main>
    <div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4">
      <div class="px-0">
        <div class="mb-3 d-flex px-3 px-md-3 px-lg-5">
          <div class="flex-auto min-width-0 width-fit mr-3">
            <div class="d-flex">
              <div class="d-none d-md-block">
                <a class="avatar mr-2 flex-shrink-0" href="https://pink-spider.github.io/">
                  <img class=" avatar-user"
                    src="/images/logo_pinkspider.png"
                    width="32" height="32" alt="Pink Spider"></a>
              </div>
              <div class="d-flex flex-column">
                <h1 class="break-word f3 text-normal mb-md-0 mb-1">
                  <span class="author">
                    <a href="https://pink-spider.github.io/">Pink Spider</a></span><span
                    class="path-divider">/</span><strong class="css-truncate-target mr-1" style="max-width: 410px"><a
                      href="https://pink-spider.github.io/post/til/idempotence/">멱등성(Idempotence)에 대하여</a></strong>
                </h1>
                <div class="note m-0">
                  Created <relative-time datetime="Mon, 26 May 2025 20:20:45 &#43;0900"
                    class="no-wrap">
                    Mon, 26 May 2025 20:20:45 &#43;0900</relative-time>

                  
                  <span class="file-info-divider"></span>
                  Modified <relative-time datetime="Mon, 08 Dec 2025 08:41:47 &#43;0900"
                    class="no-wrap">
                    Mon, 08 Dec 2025 08:41:47 &#43;0900</relative-time>
                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-lg px-3 new-discussion-timeline">
      <div class="repository-content gist-content">
        <div>
          <div class="js-gist-file-update-container js-task-list-container file-box">
            <div id="file-pytest" class="file my-2">
              <div id="post-header" class="file-header d-flex flex-md-items-center flex-items-start sticky-header" style="z-index: 2">
                <div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
                  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                    
                    <summary id="toc-toggle" onclick="clickToc()" class="btn btn-octicon m-0 mr-2 p-2">
                      <svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered">
                        <path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"></path>
                      </svg>
                    </summary>
                    <details-menu class="SelectMenu" id="toc-details" style="display: none;">
                      <div class="SelectMenu-modal rounded-3 mt-1" style="max-height: 340px;">
                        <div class="SelectMenu-list SelectMenu-list--borderless p-2" style="overscroll-behavior: contain;" id="toc-list">
                        </div>
                      </div>
                    </details-menu>
                      1734 Words
                    <span class="file-info-divider"></span>
                                        8 min

                  </div>
                  <div class="file-actions flex-order-2 pt-0">
                    
                  </div>
                </div>
              </div>


              <div class="Box-body px-5 pb-5" style="z-index: 1">
                <article class="markdown-body entry-content container-lg"><p>멱등성(Idempotence)은 컴퓨터 과학에서 자주 등장하는 중요한 개념입니다. 아래에 일반적인 의미와 API 개발과의 관련성을 나누어 자세히 설명드리겠습니다.</p>
<hr>
<h2 id="-멱등성idempotence이란">💡 멱등성(Idempotence)이란?</h2>
<p>멱등성이란 <strong>동일한 연산을 여러 번 수행해도 결과가 같아지는 성질</strong>을 말합니다. 수학에서 출발한 개념인데, 예를 들어 함수 <code>f(x)</code>가 있을 때 다음이 성립하면 멱등함수라고 합니다:</p>
<pre tabindex="0"><code>f(f(x)) = f(x)
</code></pre><h3 id="예시-수학적-관점">예시 (수학적 관점)</h3>
<ul>
<li>절댓값 함수: <code>| |x|| = |x|</code></li>
<li>집합의 합집합 연산: <code>A ∪ A = A</code></li>
</ul>
<hr>
<h2 id="-멱등성과-api-개발">🌐 멱등성과 API 개발</h2>
<p>웹 API 설계 시, 멱등성은 <strong>안정적이고 예측 가능한 API</strong>를 만들기 위해 매우 중요한 성질입니다. 특히 REST API에서는 각 HTTP 메서드가 멱등성을 가질지를 설계 시 명확히 고려해야 합니다.</p>
<h3 id="http-메서드와-멱등성">HTTP 메서드와 멱등성</h3>
<table>
  <thead>
      <tr>
          <th>HTTP 메서드</th>
          <th>멱등성 여부</th>
          <th>설명</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>GET</td>
          <td>✅ 멱등성 O</td>
          <td>같은 자원을 조회하기 때문에 여러 번 요청해도 결과는 동일</td>
      </tr>
      <tr>
          <td>PUT</td>
          <td>✅ 멱등성 O</td>
          <td>자원을 “덮어쓰기” 하기 때문에 같은 데이터로 요청하면 항상 동일한 상태 유지</td>
      </tr>
      <tr>
          <td>DELETE</td>
          <td>✅ 멱등성 O</td>
          <td>이미 삭제된 자원을 다시 삭제 요청해도 에러는 없고, 상태는 동일</td>
      </tr>
      <tr>
          <td>POST</td>
          <td>❌ 멱등성 X</td>
          <td>새로운 자원을 생성하므로 여러 번 호출하면 중복 생성될 수 있음</td>
      </tr>
      <tr>
          <td>PATCH</td>
          <td>❌ (보통은)</td>
          <td>일부만 수정하므로, 같은 요청 반복 시 결과가 달라질 수 있음</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-예시를-통한-이해">🎯 예시를 통한 이해</h2>
<h3 id="-멱등한-api-예제-put">✅ 멱등한 API 예제 (<code>PUT</code>)</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="err">PUT /users/123
</span></span></span><span class="line"><span class="cl"><span class="err">Body: {
</span></span></span><span class="line"><span class="cl"><span class="err">  &#34;name&#34;: &#34;Alice&#34;,
</span></span></span><span class="line"><span class="cl"><span class="err">  &#34;email&#34;: &#34;alice@example.com&#34;
</span></span></span><span class="line"><span class="cl"><span class="err">}
</span></span></span></code></pre></div><ul>
<li>같은 요청을 여러 번 보내도 사용자 123의 정보는 항상 위 내용으로 덮어쓰기 되므로 <strong>멱등성 O</strong></li>
</ul>
<h3 id="-멱등하지-않은-api-예제-post">❌ 멱등하지 않은 API 예제 (<code>POST</code>)</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="err">POST /orders
</span></span></span><span class="line"><span class="cl"><span class="err">Body: {
</span></span></span><span class="line"><span class="cl"><span class="err">  &#34;item&#34;: &#34;book&#34;,
</span></span></span><span class="line"><span class="cl"><span class="err">  &#34;quantity&#34;: 1
</span></span></span><span class="line"><span class="cl"><span class="err">}
</span></span></span></code></pre></div><ul>
<li>같은 요청을 여러 번 보내면 주문이 여러 개 생성될 수 있음 → <strong>멱등성 X</strong></li>
</ul>
<hr>
<h2 id="-왜-멱등성이-중요한가">🛡️ 왜 멱등성이 중요한가?</h2>
<ol>
<li>
<p><strong>재시도 로직에서 안전성 확보</strong></p>
<ul>
<li>네트워크 오류, 타임아웃으로 인한 재요청 시 멱등성이 보장되면 중복 요청으로 인한 문제를 방지할 수 있음.</li>
</ul>
</li>
<li>
<p><strong>클라이언트-서버 간 신뢰성 강화</strong></p>
<ul>
<li>어떤 요청을 여러 번 보냈을 때 항상 같은 결과라면 시스템의 신뢰성과 유지보수성이 향상됨.</li>
</ul>
</li>
<li>
<p><strong>Load Balancer / Proxy / Retry System에서 유리</strong></p>
<ul>
<li>중간 장비나 클라이언트가 자동 재시도를 수행할 때도, 멱등성 여부에 따라 부작용 여부가 결정됨.</li>
</ul>
</li>
</ol>
<hr>
<h2 id="-정리">📌 정리</h2>
<ul>
<li>멱등성은 &ldquo;동일한 연산을 여러 번 수행해도 결과가 같다&quot;는 개념.</li>
<li>API 설계 시에는 HTTP 메서드의 특성과 멱등성 여부를 고려해야 함.</li>
<li><strong>재시도 가능한 안정적인 API 설계</strong>에 있어 멱등성은 핵심 고려 요소 중 하나임.</li>
</ul>
<p>좋습니다! 멱등성을 고려한 API 설계 패턴과 <strong>재시도-safe한 시스템 구현 예제</strong>를 구체적으로 정리해드리겠습니다.</p>
<hr>
<h2 id="-1-멱등성을-고려한-api-설계-패턴">🧱 1. 멱등성을 고려한 API 설계 패턴</h2>
<h3 id="-패턴-1-put-사용으로-자원-전체-덮어쓰기">✅ 패턴 1: <strong><code>PUT</code> 사용으로 자원 전체 덮어쓰기</strong></h3>
<ul>
<li>
<p><strong>설명</strong>: 동일한 요청을 여러 번 보내도 항상 자원이 같은 상태로 유지됨.</p>
</li>
<li>
<p><strong>예제</strong>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="err">PUT /users/123
</span></span></span><span class="line"><span class="cl"><span class="err">{
</span></span></span><span class="line"><span class="cl"><span class="err">  &#34;name&#34;: &#34;Alice&#34;,
</span></span></span><span class="line"><span class="cl"><span class="err">  &#34;email&#34;: &#34;alice@example.com&#34;
</span></span></span><span class="line"><span class="cl"><span class="err">}
</span></span></span></code></pre></div><ul>
<li>여러 번 호출해도 항상 동일한 상태 유지.</li>
</ul>
</li>
</ul>
<hr>
<h3 id="-패턴-2-클라이언트에서-idempotency-key-사용">✅ 패턴 2: <strong>클라이언트에서 <code>idempotency key</code> 사용</strong></h3>
<ul>
<li>
<p><strong>설명</strong>: 중복 요청을 방지하기 위해 요청에 고유 식별자(예: UUID)를 함께 전송.</p>
</li>
<li>
<p><strong>주로 사용하는 메서드</strong>: <code>POST</code> (비멱등 메서드에 멱등성을 부여)</p>
</li>
<li>
<p><strong>헤더 예시</strong>:</p>
<pre tabindex="0"><code>POST /payments
Idempotency-Key: 123e4567-e89b-12d3-a456-426614174000
Body: {
  &#34;amount&#34;: 1000,
  &#34;card&#34;: &#34;**** **** **** 1234&#34;
}
</code></pre></li>
<li>
<p><strong>서버 동작 방식</strong>:</p>
<ul>
<li>서버는 <code>Idempotency-Key</code>를 기준으로 요청 결과를 캐싱하거나 DB에 저장.</li>
<li>같은 키로 요청이 오면 이전 응답을 그대로 반환 → 중복 처리 방지.</li>
</ul>
</li>
</ul>
<hr>
<h3 id="-패턴-3-서버-측-상태-저장-request-tracking-table">✅ 패턴 3: <strong>서버 측 상태 저장 (Request Tracking Table)</strong></h3>
<ul>
<li>
<p><strong>설명</strong>: 처리된 요청을 기록하고, 동일 요청이 다시 들어오면 이전 응답을 반환하거나 무시.</p>
</li>
<li>
<p><strong>예시</strong>: 주문, 결제, 송금 등에서 중복 요청 방지.</p>
</li>
<li>
<p><strong>구현 방식</strong>:</p>
<ul>
<li>요청마다 고유 트랜잭션 ID (예: <code>transactionId</code>) 포함.</li>
<li>DB에 트랜잭션 ID 저장 후 중복 여부 검사.</li>
</ul>
</li>
</ul>
<hr>
<h2 id="-2-재시도-safe한-시스템-구현-예제">⚙️ 2. 재시도-safe한 시스템 구현 예제</h2>
<h3 id="-예제-결제-처리-api-post-payments">💳 예제: 결제 처리 API (<code>POST /payments</code>)</h3>
<h4 id="클라이언트-측-요청">클라이언트 측 요청</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="err">POST /payments
</span></span></span><span class="line"><span class="cl"><span class="err">Headers:
</span></span></span><span class="line"><span class="cl"><span class="err">  Idempotency-Key: d9f3e1ae-45b4-4f2f-b8d1-63e67256b9ea
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">Body:
</span></span></span><span class="line"><span class="cl"><span class="err">{
</span></span></span><span class="line"><span class="cl"><span class="err">  &#34;userId&#34;: 123,
</span></span></span><span class="line"><span class="cl"><span class="err">  &#34;amount&#34;: 5000
</span></span></span><span class="line"><span class="cl"><span class="err">}
</span></span></span></code></pre></div><h4 id="서버-측-처리-로직-javaspring-기준-의사코드">서버 측 처리 로직 (Java/Spring 기준 의사코드)</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">createPayment</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">idempotencyKey</span><span class="p">,</span><span class="w"> </span><span class="n">PaymentRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Optional</span><span class="o">&lt;</span><span class="n">PaymentLog</span><span class="o">&gt;</span><span class="w"> </span><span class="n">existing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paymentRepository</span><span class="p">.</span><span class="na">findByIdempotencyKey</span><span class="p">(</span><span class="n">idempotencyKey</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">existing</span><span class="p">.</span><span class="na">isPresent</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="p">.</span><span class="na">ok</span><span class="p">(</span><span class="n">existing</span><span class="p">.</span><span class="na">get</span><span class="p">().</span><span class="na">getResponse</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">PaymentResult</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paymentService</span><span class="p">.</span><span class="na">charge</span><span class="p">(</span><span class="n">request</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">PaymentLog</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PaymentLog</span><span class="p">(</span><span class="n">idempotencyKey</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">paymentRepository</span><span class="p">.</span><span class="na">save</span><span class="p">(</span><span class="n">log</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="p">.</span><span class="na">ok</span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="결과">결과:</h4>
<ul>
<li>같은 결제 요청을 재시도해도 <strong>중복 결제 없이</strong> 이전 결제 결과를 그대로 반환함.</li>
<li><strong>결제 시스템, 주문 시스템, 계좌 이체</strong> 등에서 유용하게 사용됨.</li>
</ul>
<hr>
<h2 id="-추가-설계-팁">📦 추가 설계 팁</h2>
<h3 id="-재시도-가능-로직과-함께-사용할-수-있는-전략">🔁 재시도 가능 로직과 함께 사용할 수 있는 전략</h3>
<ul>
<li><strong>재시도 지연(backoff)</strong>: 네트워크 실패 등에서 지수적으로 요청 간 간격 증가.</li>
<li><strong><code>Retry-After</code> 헤더</strong>: 서버가 일정 시간 이후 재시도를 유도.</li>
<li><strong>Circuit Breaker 패턴</strong>: 실패율이 높은 경우 일시적으로 요청을 차단.</li>
</ul>
<h3 id="-재시도-시-주의사항">🛑 재시도 시 주의사항</h3>
<table>
  <thead>
      <tr>
          <th>상황</th>
          <th>주의</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>재고 감소, 포인트 차감 등 가변 상태</td>
          <td>멱등성 미보장 시 중복 차감 위험</td>
      </tr>
      <tr>
          <td>외부 시스템 호출</td>
          <td>외부 시스템이 멱등성을 제공하는지 확인 필수</td>
      </tr>
      <tr>
          <td>DB 트랜잭션 처리</td>
          <td>트랜잭션 ID를 활용한 안전한 중복 방지 로직 필요</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-정리-1">✅ 정리</h2>
<ul>
<li>멱등성은 <strong>요청 재시도와 장애 대응</strong>에서 핵심.</li>
<li><code>PUT</code>, <code>DELETE</code>는 기본적으로 멱등, <code>POST</code>는 <code>Idempotency-Key</code> 등으로 보완.</li>
<li>서버에서 <strong>요청 추적</strong>, <strong>응답 캐싱</strong>, <strong>DB 중복 검사</strong> 등을 통해 시스템적으로 멱등성을 구현할 수 있음.</li>
</ul>
<hr>
</article>
              </div>

              
            </div>
          </div>
        </div>
      </div>

      <div class="pagination-nav">
        <div class="pagination-button next-post">
          
          <div>«&nbsp;</div><a class="pagination-link link-reverse" href="https://pink-spider.github.io/post/til/singleton_pattern/"> Singleton Pattern</a>
          
        </div>
        
        <div class="pagination-button previous-post">
          
          <a class="pagination-link link-reverse" href="https://pink-spider.github.io/post/spring/about_list/">Object[] 와 ArrayList&lt;Object&gt; 의 차이&nbsp;</a><div> »</div>
          
        </div>
      </div>
    </div>
  </main>
</div>
<script type="application/javascript" src='https://pink-spider.github.io/js/toc.js'></script>
<link rel="stylesheet" href='https://pink-spider.github.io/css/toc.css' />

<div id="gitalk-container" class="gitalk-container"></div>
<link rel="stylesheet" href='https://pink-spider.github.io/css/gitalk.css'>
<script src='https://pink-spider.github.io/js/gitalk.min.js'></script>
<script>
  const gitalk = new Gitalk({
    accessToken: '',
    repo: 'pink-spider.github.io',
    owner: 'pink-spider',
    admin: ['pink-spider'],
    id: eval("location.pathname"), 
    distractionFreeMode: false 
  });
  (function() {
    gitalk.render('gitalk-container');
  })();
</script>


  <div class="footer container-xl width-full p-responsive">
  <div
    class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light"
  >
    <ul
      class="list-style-none d-flex flex-wrap col-12 flex-justify-center mb-2 mb-lg-0"
    >
      
    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>
</div>

</body>

<script type="application/javascript" src="https://pink-spider.github.io/js/github-style.js"></script>

<script src="https://pink-spider.github.io/js/mark.es6.min.js"></script>


<script type="text/javascript">

  const host = window.location.host;
  const keyword = localStorage.getItem('keyword');
  localStorage.removeItem('keyword');

  if (keyword) {
    const markInstance = new Mark(document.body);
    markInstance.unmark({
      done: function() {
        markInstance.mark(keyword);
      }
    });
  }

  const primaryColor = getComputedStyle(document.documentElement).getPropertyValue('--color-bg-primary');
  const mutedColor = getComputedStyle(document.documentElement).getPropertyValue('--color-fg-muted');
  const hoverColor = '#216EEB';

  let originalStyle;
  let svgOriginalStyle;
  let titleOriginalStyle;

  const onMouseOver = (node) => {
    originalStyle = Object.assign({}, node.style);
    node.style.backgroundColor = hoverColor;

    const child = node.querySelector('.js-jump');
    child.classList.remove('d-on-nav-focus');

    const title = node.querySelector('.title');
    if (title && primaryColor === ' #fff') {
      titleOriginalStyle = title.style;
      title.style.color = '#fff';
    }

    const svg = node.querySelector('.octicon');
    if (svg) {
      svgOriginalStyle = svg.style;
      svg.style.color = '#fff';
    }
  }

  const onMouseLeave = (node) => {
    node.style = originalStyle;
    const child = node.querySelector('.js-jump');
    child.classList.add('d-on-nav-focus');

    const title = node.querySelector('.title');
    title.style = titleOriginalStyle;

    const svg = node.querySelector('.octicon');
    svg.style = svgOriginalStyle;
  }

  const createSearchItem = (title, link, index) => {
    return `
    <li class="color-bg-primary search-item d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-scoped-search"
        role="option" aria-selected="false" tabindex="${index}">
        <a onmouseover="onMouseOver(this)" onmouseleave="onMouseLeave(this)"
          class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2"
          href="${link}" data-item-type="scoped_search">
          <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center ">
            <svg title="Repository" aria-label="Repository" role="img" height="16" viewBox="0 0 16 16"
              version="1.1" width="16" data-view-component="true"
              class="octicon octicon-repo js-jump-to-octicon-repo  flex-shrink-0">
              <path fill-rule="evenodd"
                d="M2 2.5A2.5 2.5 0 014.5 0h8.75a.75.75 0 01.75.75v12.5a.75.75 0 01-.75.75h-2.5a.75.75 0 110-1.5h1.75v-2h-8a1 1 0 00-.714 1.7.75.75 0 01-1.072 1.05A2.495 2.495 0 012 11.5v-9zm10.5-1V9h-8c-.356 0-.694.074-1 .208V2.5a1 1 0 011-1h8zM5 12.25v3.25a.25.25 0 00.4.2l1.45-1.087a.25.25 0 01.3 0L8.6 15.7a.25.25 0 00.4-.2v-3.25a.25.25 0 00-.25-.25h-3.5a.25.25 0 00-.25.25z">
              </path>
            </svg>
          </div>    

          <div
            class="title jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
            ${title}
          </div>

          <div aria-hidden="true" style="color: var(--color-fg-muted);"
            class="color-bg-primary js-jump border rounded-2 flex-shrink-0 color-bg-subtle px-1 ml-1 f6 d-on-nav-focus js-jump-to-badge-jump">
            Jump to
            <span class="d-inline-block ml-1 v-align-middle">↵</span>
          </div>
        </a>
      </li>
    `
  }

  const createGoogleSearchItem = (keyword) => {
    return `
    <li class="color-bg-primary search-item d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-scoped-search"
        role="option" aria-selected="false" tabindex="0">
        <a onmouseover="onMouseOver(this)" onmouseleave="onMouseLeave(this)"
          class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2"
          href="https://www.google.com/search?q=${keyword}" target="_blank" data-item-type="scoped_search">
          <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center ">
            <svg title="Search" aria-label="Search" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-search js-jump-to-octicon-search flex-shrink-0">
                <path fill-rule="evenodd" d="M11.5 7a4.499 4.499 0 11-8.998 0A4.499 4.499 0 0111.5 7zm-.82 4.74a6 6 0 111.06-1.06l3.04 3.04a.75.75 0 11-1.06 1.06l-3.04-3.04z"></path>
            </svg>
          </div>    

          <div
            class="title jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
            ${keyword}
          </div>

          <div aria-hidden="true" style="color: var(--color-fg-muted);"
            class="color-bg-primary js-jump border rounded-2 flex-shrink-0 color-bg-subtle px-1 ml-1 f6 d-on-nav-focus js-jump-to-badge-jump">
            Google search
            <span class="d-inline-block ml-1 v-align-middle">↵</span>
          </div>
        </a>
      </li>
    `
  }

  const stripHtml = (html) => {
    let tmp = document.createElement('div');
    tmp.innerHTML = html;

    
    const styles = tmp.getElementsByTagName('style');
    while(styles[0]) {
      styles[0].parentNode.removeChild(styles[0]);
    }

    
    const scripts = tmp.getElementsByTagName('script');
    while(scripts[0]) {
      scripts[0].parentNode.removeChild(scripts[0]);
    }
    
    return tmp.textContent || tmp.innerText || "";
  }

  const inputDom = document.querySelector(".Header-search-input");
  const resultDom = document.getElementById('jump-to-results');
  let debounceTimer;
  let parser;
  let xmlDoc;

  const search = (_keyword) => {

    resultDom.innerHTML = '';

    const keyword = _keyword;

    if (!keyword) return;

    const progressDom = document.getElementById('search-progress');
    if (progressDom && progressDom.classList.contains('d-none')) {
      progressDom.classList.remove('d-none');
    }

    localStorage.setItem('keyword', keyword);
    fetch(`${host.indexOf('localhost') > -1 ? 'http://' : 'https://'}${host}/index.xml`).then(resp => resp.text()).then(async (res) => {
      parser = new DOMParser();
      xmlDoc = parser.parseFromString(res, 'text/xml');
      const linkResult = xmlDoc.getElementsByTagName('link');
      const titleResult = xmlDoc.getElementsByTagName('title');
      const arr = [];

      const matched = [];
      await (async function searchLink() {
        for (let i = 0; i < linkResult.length; i++) {
          await fetch(linkResult[i].textContent).then(resp => resp.text().then(res => {
            const pureText = stripHtml(res);
            if (pureText.indexOf(keyword) >= 0) {
              matched.push(i);
            }
          }))
        }
      })();

      const googleSearchItem = createGoogleSearchItem(keyword);
      const node= document.createRange().createContextualFragment(googleSearchItem);
      resultDom.appendChild(node);

      matched.map((itemIndex, index) => {
        const r = createSearchItem(titleResult[itemIndex].textContent, linkResult[itemIndex].textContent, index + 1);
        const node = document.createRange().createContextualFragment(r);
        resultDom.appendChild(node);
      });

      if (progressDom && !progressDom.classList.contains('d-none')) {
        progressDom.classList.add('d-none');
      }
    });
  }

  const debounce = (callback, time) => {
    window.clearTimeout(debounceTimer);
    debounceTimer = window.setTimeout(callback, time);
  };

  ['focus', 'input'].forEach(event => {
    inputDom.addEventListener(event, (e) => {
      debounce(() => search(e.target.value), 500);
    }, false);
  });

  inputDom.addEventListener('blur', () => {
    setTimeout(() => {
      resultDom.innerHTML = '';
    }, 100);
  });

</script>






</html>