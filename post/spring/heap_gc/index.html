<!DOCTYPE html>
<html lang="ko-KR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width" />
  <script
    type="application/javascript"
    src='https://pink-spider.github.io/js/theme-mode.js'
  ></script>
  <link rel="stylesheet" href='https://pink-spider.github.io/css/frameworks.min.css' />
  <link rel="stylesheet" href='https://pink-spider.github.io/css/github.min.css' />
  <link rel="stylesheet" href='https://pink-spider.github.io/css/github-style.css' />
  <link rel="stylesheet" href='https://pink-spider.github.io/css/light.css' />
  <link rel="stylesheet" href='https://pink-spider.github.io/css/dark.css' />
  <link rel="stylesheet" href='https://pink-spider.github.io/css/syntax.css' />
  
  <link rel="stylesheet" href="/your%20css%20file%20name" />
  
  <title>
    JVM에서 Heap 메모리의 용도와 GC 튜닝 | Pink Spider
  </title>
  
  <link rel="icon" type="image/x-icon" href="/images/logo_pinkspider.png" />
  
  <meta name="theme-color" content="#1e2327" />

  
  <meta
  name="description"
  content="JVM(Java Virtual Machine)에서 heap 메모리는 자바 애플리케이션이 런타임 시 동적으로 생성하는 객체들이 저장되는 영역입니다. 즉, new 키워드를 사용해서 생성하는 대부분의 객체들이 이 영역에 저장됩니다.
📌 Heap 메모리 구성 Heap은 크게 다음 두 영역으로 나뉩니다:
Young Generation (Young Gen): 새로 생성된 객체가 저장되는 곳. Eden: 대부분의 새 객체가 여기에 생성됨. Survivor: Eden에서 살아남은 객체들이 이동. Old Generation (Tenured Gen): Young Gen을 거쳐 오래 살아남은 객체들이 이동하는 공간. Garbage Collector(GC)는 이 heap 영역의 객체들을 주기적으로 검사해서 더 이상 참조되지 않는 객체는 메모리에서 제거합니다.
"
/>
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://pink-spider.github.io/post/spring/heap_gc/" />


<meta name="twitter:card" content="summary" />
<meta
  name="twitter:title"
  content="JVM에서 Heap 메모리의 용도와 GC 튜닝 - Pink Spider"
/>
<meta
  name="twitter:description"
  content="JVM(Java Virtual Machine)에서 heap 메모리는 자바 애플리케이션이 런타임 시 동적으로 생성하는 객체들이 저장되는 영역입니다. 즉, new 키워드를 사용해서 생성하는 대부분의 객체들이 이 영역에 저장됩니다.
📌 Heap 메모리 구성 Heap은 크게 다음 두 영역으로 나뉩니다:
Young Generation (Young Gen): 새로 생성된 객체가 저장되는 곳. Eden: 대부분의 새 객체가 여기에 생성됨. Survivor: Eden에서 살아남은 객체들이 이동. Old Generation (Tenured Gen): Young Gen을 거쳐 오래 살아남은 객체들이 이동하는 공간. Garbage Collector(GC)는 이 heap 영역의 객체들을 주기적으로 검사해서 더 이상 참조되지 않는 객체는 메모리에서 제거합니다.
"
/>
<meta name="twitter:site" content="https://pink-spider.github.io/" />
<meta name="twitter:creator" content="" />
<meta
  name="twitter:image"
  content="https://pink-spider.github.io/"
/>


<meta
  property="og:type"
  content="article"
/>
<meta
  property="og:title"
  content="JVM에서 Heap 메모리의 용도와 GC 튜닝 - Pink Spider"
/>
<meta
  property="og:description"
  content="JVM(Java Virtual Machine)에서 heap 메모리는 자바 애플리케이션이 런타임 시 동적으로 생성하는 객체들이 저장되는 영역입니다. 즉, new 키워드를 사용해서 생성하는 대부분의 객체들이 이 영역에 저장됩니다.
📌 Heap 메모리 구성 Heap은 크게 다음 두 영역으로 나뉩니다:
Young Generation (Young Gen): 새로 생성된 객체가 저장되는 곳. Eden: 대부분의 새 객체가 여기에 생성됨. Survivor: Eden에서 살아남은 객체들이 이동. Old Generation (Tenured Gen): Young Gen을 거쳐 오래 살아남은 객체들이 이동하는 공간. Garbage Collector(GC)는 이 heap 영역의 객체들을 주기적으로 검사해서 더 이상 참조되지 않는 객체는 메모리에서 제거합니다.
"
/>
<meta property="og:url" content="https://pink-spider.github.io/post/spring/heap_gc/" />
<meta property="og:site_name" content="JVM에서 Heap 메모리의 용도와 GC 튜닝" />
<meta
  property="og:image"
  content="https://pink-spider.github.io/"
/>
<meta property="og:image:width" content="2048" />
<meta property="og:image:height" content="1024" />

<meta property="article:published_time" content="2025-04-01 13:59:38 &#43;0900 KST" />















</head>


<body>
  

<style>
  .height-limitation {
    max-height: 300px;
    overflow-y: scroll;
  }

  .loader {
    border: 4px solid #f3f3f3;
    border-bottom: 4px solid var(--color-fg-muted);
    border-radius: 50%;
    width: 30px;
    height: 30px;
    animation: spin 1s linear infinite;
    margin: 0 auto;
  }

  @keyframes spin {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }
</style>

<div style="position: relative">
  <header
    class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on"
  >
    <div
      class="Header-item mobile-none"
      style="margin-top: -4px; margin-bottom: -4px"
    >
      <a class="Header-link" href="https://pink-spider.github.io/" aria-label="Home">
        <svg
          class="octicon"
          height="32"
          viewBox="0 0 16 16"
          version="1.1"
          width="32"
        >
          <path
            fill-rule="evenodd"
            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"
          ></path>
        </svg>
      </a>
    </div>
    <div class="Header-item d-md-none">
      <button
        class="Header-link btn-link js-details-target"
        type="button"
        onclick="document.querySelector('#header-search').style.display = document.querySelector('#header-search').style.display == 'none'? 'block': 'none'"
        aria-label="Search"
      >
        <svg
          height="24"
          class="octicon octicon-three-bars"
          viewBox="0 0 16 16"
          version="1.1"
          width="24"
        >
          <path
            fill-rule="evenodd"
            d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z"
          ></path>
        </svg>
      </button>
    </div>
    <div
      style="display: none"
      id="header-search"
      class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex"
    >
      <div
        class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to"
      >
        <div class="position-relative">
          <form
            target="_blank"
            action="https://www.google.com/search"
            accept-charset="UTF-8"
            method="get"
            autocomplete="off"
          >
            <label
              class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center"
            >
              <input
                type="text"
                class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable"
                name="q"
                value=""
                placeholder="Search"
                autocomplete="off"
              />
              <input type="hidden" name="q" value="site:https://pink-spider.github.io/" />
              <div
                class="js-jump-to-suggestions-container jump-to-suggestions overflow-hidden position-absolute"
              >
                <div
                  id="search-progress"
                  class="d-none color-bg-primary no-underline p-2"
                  role="progress"
                  aria-selected="false"
                >
                  <div class="loader"></div>
                </div>

                <ul
                  id="jump-to-results"
                  role="listbox"
                  class="Box border-0 p-0 m-0 js-navigation-container jump-to-suggestions-results-container js-jump-to-suggestions-results-container js-active-navigation-container height-limitation"
                ></ul>
              </div>
            </label>
          </form>
        </div>
      </div>
    </div>

    <div
      class="Header-item Header-item--full flex-justify-center d-md-none position-relative"
    >
      <a class="Header-link" href="https://pink-spider.github.io/" aria-label="Home">
        <svg
          class="octicon octicon-mark-github v-align-middle"
          height="32"
          viewBox="0 0 16 16"
          version="1.1"
          width="32"
        >
          <path
            fill-rule="evenodd"
            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"
          ></path>
        </svg>
      </a>
    </div>
    <div class="Theme-switcher Header-item" style="margin-right: 0">
      <span
        role="button"
        class="Header-link no-select"
        onclick="switchTheme()"
        style="cursor: pointer"
        aria-label="Switch theme"
      >
        <svg
          style="fill: var(--color-profile-color-modes-toggle-moon)"
          class="no-select"
          viewBox="0 0 16 16"
          version="1.1"
          width="16"
          height="16"
        >
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M4.52208 7.71754C7.5782 7.71754 10.0557 5.24006 10.0557 2.18394C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961C9.95801 1.07727 10.3495 0.771159 10.6474 0.99992C12.1153 2.12716 13.0615 3.89999 13.0615 5.89383C13.0615 9.29958 10.3006 12.0605 6.89485 12.0605C3.95334 12.0605 1.49286 10.001 0.876728 7.24527C0.794841 6.87902 1.23668 6.65289 1.55321 6.85451C2.41106 7.40095 3.4296 7.71754 4.52208 7.71754Z"
          ></path>
        </svg>
      </span>
    </div>
  </header>
</div>

  
<div>
  <main>
    <div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4">
      <div class="px-0">
        <div class="mb-3 d-flex px-3 px-md-3 px-lg-5">
          <div class="flex-auto min-width-0 width-fit mr-3">
            <div class="d-flex">
              <div class="d-none d-md-block">
                <a class="avatar mr-2 flex-shrink-0" href="https://pink-spider.github.io/">
                  <img class=" avatar-user"
                    src="/images/logo_pinkspider.png"
                    width="32" height="32" alt="Pink Spider"></a>
              </div>
              <div class="d-flex flex-column">
                <h1 class="break-word f3 text-normal mb-md-0 mb-1">
                  <span class="author">
                    <a href="https://pink-spider.github.io/">Pink Spider</a></span><span
                    class="path-divider">/</span><strong class="css-truncate-target mr-1" style="max-width: 410px"><a
                      href="https://pink-spider.github.io/post/spring/heap_gc/">JVM에서 Heap 메모리의 용도와 GC 튜닝</a></strong>
                </h1>
                <div class="note m-0">
                  Created <relative-time datetime="Tue, 01 Apr 2025 13:59:38 &#43;0900"
                    class="no-wrap">
                    Tue, 01 Apr 2025 13:59:38 &#43;0900</relative-time>

                  
                  <span class="file-info-divider"></span>
                  Modified <relative-time datetime="Tue, 01 Apr 2025 14:08:06 &#43;0900"
                    class="no-wrap">
                    Tue, 01 Apr 2025 14:08:06 &#43;0900</relative-time>
                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-lg px-3 new-discussion-timeline">
      <div class="repository-content gist-content">
        <div>
          <div class="js-gist-file-update-container js-task-list-container file-box">
            <div id="file-pytest" class="file my-2">
              <div id="post-header" class="file-header d-flex flex-md-items-center flex-items-start sticky-header" style="z-index: 2">
                <div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
                  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                    
                    <summary id="toc-toggle" onclick="clickToc()" class="btn btn-octicon m-0 mr-2 p-2">
                      <svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered">
                        <path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"></path>
                      </svg>
                    </summary>
                    <details-menu class="SelectMenu" id="toc-details" style="display: none;">
                      <div class="SelectMenu-modal rounded-3 mt-1" style="max-height: 340px;">
                        <div class="SelectMenu-list SelectMenu-list--borderless p-2" style="overscroll-behavior: contain;" id="toc-list">
                        </div>
                      </div>
                    </details-menu>
                      1814 Words
                    <span class="file-info-divider"></span>
                                        8 min

                  </div>
                  <div class="file-actions flex-order-2 pt-0">
                    
                  </div>
                </div>
              </div>


              <div class="Box-body px-5 pb-5" style="z-index: 1">
                <article class="markdown-body entry-content container-lg"><p>JVM(Java Virtual Machine)에서 <strong>heap 메모리</strong>는 자바 애플리케이션이 <strong>런타임 시 동적으로 생성하는 객체들이 저장되는 영역</strong>입니다. 즉, <code>new</code> 키워드를 사용해서 생성하는 대부분의 객체들이 이 영역에 저장됩니다.</p>
<hr>
<h3 id="-heap-메모리-구성">📌 Heap 메모리 구성</h3>
<p>Heap은 크게 다음 두 영역으로 나뉩니다:</p>
<ul>
<li><strong>Young Generation (Young Gen)</strong>: 새로 생성된 객체가 저장되는 곳.
<ul>
<li><strong>Eden</strong>: 대부분의 새 객체가 여기에 생성됨.</li>
<li><strong>Survivor</strong>: Eden에서 살아남은 객체들이 이동.</li>
</ul>
</li>
<li><strong>Old Generation (Tenured Gen)</strong>: Young Gen을 거쳐 오래 살아남은 객체들이 이동하는 공간.</li>
</ul>
<p>Garbage Collector(GC)는 이 heap 영역의 객체들을 주기적으로 검사해서 <strong>더 이상 참조되지 않는 객체는 메모리에서 제거</strong>합니다.</p>
<hr>
<h3 id="-memory-leak-이란">💣 Memory Leak 이란?</h3>
<p>자바에서는 개발자가 직접 메모리를 해제하지 않기 때문에 메모리 누수가 없다고 오해하기 쉬운데, <strong>참조는 남아있지만 실제로 더 이상 사용하지 않는 객체가 GC의 대상이 되지 못할 때</strong> 메모리 누수가 발생합니다.</p>
<hr>
<h3 id="-메모리-누수를-막기-위한-개발자의-역할">✅ 메모리 누수를 막기 위한 개발자의 역할</h3>
<ol>
<li>
<p><strong>불필요한 참조 제거</strong></p>
<ul>
<li>더 이상 필요 없는 객체는 참조를 <code>null</code>로 설정하거나 컬렉션에서 제거해야 GC가 수거할 수 있습니다.</li>
<li>예: <code>List</code>, <code>Map</code>, <code>Set</code> 등에 오래된 데이터를 계속 담아두는 경우.</li>
</ul>
</li>
<li>
<p><strong>Static 변수 관리</strong></p>
<ul>
<li>Static은 클래스 로딩 시 생성되어 애플리케이션 종료 전까지 유지됩니다.</li>
<li>필요 이상으로 많은 데이터를 static으로 들고 있으면 GC 대상이 되지 않음.</li>
</ul>
</li>
<li>
<p><strong>리스너나 콜백 해제</strong></p>
<ul>
<li>등록한 이벤트 리스너, 콜백 등을 적절한 시점에 해제하지 않으면 객체가 계속 참조됨.</li>
</ul>
</li>
<li>
<p><strong>WeakReference 사용 고려</strong></p>
<ul>
<li>캐시처럼 잠깐만 데이터를 보관하고 싶은 경우 <code>WeakReference</code>, <code>SoftReference</code> 등을 사용해 GC 대상이 될 수 있게 설계.</li>
</ul>
</li>
<li>
<p><strong>GC 로그 및 Heap Dump 분석</strong></p>
<ul>
<li><code>jvisualvm</code>, <code>jconsole</code>, <code>MAT(Memory Analyzer Tool)</code> 등을 통해 객체가 어디서 얼마나 생성되고 남아있는지 확인.</li>
</ul>
</li>
<li>
<p><strong>Finalizer, Cleaner 피하기</strong></p>
<ul>
<li><code>finalize()</code>는 예측이 어렵고 GC를 지연시킬 수 있음. 가능하면 <code>AutoCloseable</code> 인터페이스와 try-with-resources 구문을 사용할 것.</li>
</ul>
</li>
<li>
<p><strong>ThreadLocal 사용 주의</strong></p>
<ul>
<li>ThreadLocal은 잘못 관리하면 해당 Thread가 종료될 때까지 객체가 해제되지 않음.</li>
<li>사용 후 반드시 <code>remove()</code> 호출할 것.</li>
</ul>
</li>
</ol>
<hr>
<h1 id="실전에서-어떻게-메모리-누수가-생기고-우리가-어떻게-확인하고-해결할-수-있는지-예제">실전에서 어떻게 메모리 누수가 생기고, 우리가 어떻게 확인하고 해결할 수 있는지 예제</h1>
<hr>
<h2 id="-1-예제-코드-메모리-누수가-발생하는-경우">🧪 1. 예제 코드: 메모리 누수가 발생하는 경우</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MemoryLeakExample</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="n">leakedList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// 객체를 계속 생성해서 static 리스트에 넣는다</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">leakedList</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="n">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">1024</span><span class="o">]</span><span class="p">);</span><span class="w"> </span><span class="c1">// 1MB</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">100</span><span class="p">);</span><span class="w"> </span><span class="c1">// 조금씩 천천히 누수되게</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="-문제">🔥 문제</h3>
<ul>
<li><code>leakedList</code>는 static 변수라 GC의 대상이 되지 않고,</li>
<li>내부에 계속 새로운 객체를 추가하므로 Heap 메모리가 점점 차오름.</li>
<li>결국 <code>OutOfMemoryError</code> 발생.</li>
</ul>
<hr>
<h2 id="-2-메모리-누수-확인-방법-heap-dump">🛠 2. 메모리 누수 확인 방법 (Heap Dump)</h2>
<h3 id="-jvm-옵션-추가">🔍 JVM 옵션 추가</h3>
<p>프로그램 실행 시 다음 옵션을 넣으면 OOM 발생 시 Heap Dump 파일이 생성됨:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">-XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath<span class="o">=</span>./heapdump.hprof
</span></span></code></pre></div><h3 id="-분석-툴-eclipse-mat-memory-analyzer-tool">🔧 분석 툴: Eclipse MAT (Memory Analyzer Tool)</h3>
<ol>
<li><a href="https://www.eclipse.org/mat/">Eclipse MAT 다운로드</a></li>
<li><code>heapdump.hprof</code> 파일 열기</li>
<li>&ldquo;Leak Suspects Report&rdquo; 실행</li>
<li>의심되는 객체/경로 확인
<ul>
<li>예: <code>leakedList</code>가 수많은 <code>byte[]</code> 객체를 붙잡고 있는 상황 확인 가능</li>
</ul>
</li>
</ol>
<hr>
<h2 id="-3-개선된-코드-예시">✅ 3. 개선된 코드 예시</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MemoryLeakFixed</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="n">tempList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">tempList</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="n">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">1024</span><span class="o">]</span><span class="p">);</span><span class="w"> </span><span class="c1">// 1MB</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tempList</span><span class="p">.</span><span class="na">size</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">tempList</span><span class="p">.</span><span class="na">clear</span><span class="p">();</span><span class="w"> </span><span class="c1">// 참조 끊기</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">100</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>이렇게 하면 참조가 사라지고, GC가 해당 객체를 수거할 수 있어서 OOM을 방지할 수 있습니다.</p>
<hr>
<h1 id="gc-튜닝-전략">GC 튜닝 전략</h1>
<p>좋지! GC 튜닝은 JVM 성능 최적화의 핵심 중 하나야. 튜닝은 사용 중인 <strong>Garbage Collector 종류</strong>, <strong>메모리 구조</strong>, 그리고 <strong>애플리케이션의 특성</strong>에 따라 달라지는데, 아래 내용을 바탕으로 이해하고 튜닝 전략을 세우면 좋아.</p>
<hr>
<h2 id="-gc-튜닝의-핵심-목표">🧠 GC 튜닝의 핵심 목표</h2>
<ul>
<li><strong>Stop-The-World(STW)</strong> 시간을 최소화</li>
<li><strong>GC 횟수/빈도</strong> 최적화</li>
<li><strong>Throughput (총 처리량)</strong> 극대화</li>
<li><strong>Latency (응답 지연)</strong> 최소화</li>
</ul>
<hr>
<h2 id="-gc-종류-java-11-기준">🔧 GC 종류 (Java 11+ 기준)</h2>
<table>
  <thead>
      <tr>
          <th>GC 종류</th>
          <th>특징</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Serial GC</strong></td>
          <td>단일 스레드, 소규모 앱에 적합 (<code>-XX:+UseSerialGC</code>)</td>
      </tr>
      <tr>
          <td><strong>Parallel GC</strong></td>
          <td>멀티 스레드, 처리량 위주, 기본값 (<code>-XX:+UseParallelGC</code>)</td>
      </tr>
      <tr>
          <td><strong>G1 GC</strong></td>
          <td>적절한 latency + throughput (<code>-XX:+UseG1GC</code>)</td>
      </tr>
      <tr>
          <td><strong>ZGC</strong></td>
          <td>매우 낮은 지연 시간, 대용량 Heap에 적합 (<code>-XX:+UseZGC</code>)</td>
      </tr>
      <tr>
          <td><strong>Shenandoah GC</strong></td>
          <td>OpenJDK 계열 저지연 GC (<code>-XX:+UseShenandoahGC</code>)</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="-자주-사용하는-jvm-옵션">📌 자주 사용하는 JVM 옵션</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 힙 메모리 크기 설정</span>
</span></span><span class="line"><span class="cl">-Xms2g               <span class="c1"># 초기 Heap 크기</span>
</span></span><span class="line"><span class="cl">-Xmx2g               <span class="c1"># 최대 Heap 크기</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># GC 종류 선택</span>
</span></span><span class="line"><span class="cl">-XX:+UseG1GC         <span class="c1"># G1 GC 사용</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># GC 로그 출력</span>
</span></span><span class="line"><span class="cl">-verbose:gc
</span></span><span class="line"><span class="cl">-Xlog:gc*:gc.log     <span class="c1"># Java 9 이상</span>
</span></span><span class="line"><span class="cl">-XX:+PrintGCDetails  <span class="c1"># GC 상세 정보</span>
</span></span><span class="line"><span class="cl">-XX:+PrintGCDateStamps
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># GC 튜닝 예시 (G1GC 기준)</span>
</span></span><span class="line"><span class="cl">-XX:MaxGCPauseMillis<span class="o">=</span><span class="m">200</span>           <span class="c1"># GC 지연 시간을 200ms 이하로</span>
</span></span><span class="line"><span class="cl">-XX:InitiatingHeapOccupancyPercent<span class="o">=</span><span class="m">45</span>  <span class="c1"># Old GC 시작 기준점 (%)</span>
</span></span></code></pre></div><hr>
<h2 id="-gc-튜닝-전략">🧪 GC 튜닝 전략</h2>
<h3 id="1-gc-로그-분석">1. <strong>GC 로그 분석</strong></h3>
<ul>
<li>GC 로그를 확인하여 <strong>Full GC 빈도</strong>, <strong>Minor GC 시간</strong>, <strong>Pause Time</strong> 등을 파악.</li>
<li>도구: <a href="https://github.com/chewiebug/GCViewer">GCViewer</a>, <a href="https://gceasy.io">GCEasy.io</a></li>
</ul>
<h3 id="2-heap-설정-최적화">2. <strong>Heap 설정 최적화</strong></h3>
<ul>
<li>너무 작은 Heap → 잦은 GC</li>
<li>너무 큰 Heap → GC 시간 증가, 메모리 낭비</li>
<li>예: 서비스 JVM 2~4GB Heap 정도에서 시작, 관측 후 조정</li>
</ul>
<h3 id="3-객체-생존-시간에-따라-gc-전략-결정">3. <strong>객체 생존 시간에 따라 GC 전략 결정</strong></h3>
<ul>
<li>단명 객체가 많다면 Young 영역을 키우는 게 유리</li>
<li>장기 객체가 많다면 Old 영역 GC가 핵심이 됨</li>
</ul>
<h3 id="4-full-gc-줄이기">4. <strong>Full GC 줄이기</strong></h3>
<ul>
<li>메모리 누수 점검</li>
<li>캐시나 ThreadLocal 관리</li>
<li>Heap Dump 분석하여 Old Gen에 무엇이 있는지 확인</li>
</ul>
<h3 id="5-g1-gc-튜닝-팁">5. <strong>G1 GC 튜닝 팁</strong></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">-XX:+UseStringDeduplication       <span class="c1"># 중복 문자열 제거</span>
</span></span><span class="line"><span class="cl">-XX:MaxGCPauseMillis<span class="o">=</span><span class="m">200</span>          <span class="c1"># 최대 GC 지연 시간 설정</span>
</span></span><span class="line"><span class="cl">-XX:ParallelGCThreads<span class="o">=</span><span class="m">4</span>           <span class="c1"># GC에 사용할 스레드 수</span>
</span></span><span class="line"><span class="cl">-XX:ConcGCThreads<span class="o">=</span><span class="m">2</span>               <span class="c1"># Concurrent Mark 단계에 사용할 스레드 수</span>
</span></span></code></pre></div><hr>
<h2 id="-g1-gc-동작-구조-요약">🔍 G1 GC 동작 구조 요약</h2>
<ul>
<li>Heap을 여러 Region(영역)으로 쪼갬</li>
<li><strong>Young → Old → Humongous (대형 객체)</strong> 구조</li>
<li>GC는 <strong>부분적으로</strong>, <strong>병렬로</strong>, <strong>동시적으로</strong> 실행됨</li>
<li>목표: 큰 Full GC를 피하면서 <strong>짧고 자주</strong> GC</li>
</ul>
<hr>
<h2 id="-튜닝할-때-유용한-도구">📈 튜닝할 때 유용한 도구</h2>
<ul>
<li><code>jstat -gc &lt;pid&gt;</code> : JVM GC 상태 실시간 조회</li>
<li><code>jvisualvm</code>, <code>Java Mission Control</code>: GC 그래프와 Heap 확인</li>
<li><code>VisualGC</code>, <code>HeapHero</code>, <code>GCEasy.io</code>: 시각화</li>
</ul>
<hr>
</article>
              </div>

              
            </div>
          </div>
        </div>
      </div>

      <div class="pagination-nav">
        <div class="pagination-button next-post">
          
        </div>
        
        <div class="pagination-button previous-post">
          
          <a class="pagination-link link-reverse" href="https://pink-spider.github.io/post/spring/cacheable/">Cacheable 어노테이션에 대해서&nbsp;</a><div> »</div>
          
        </div>
      </div>
    </div>
  </main>
</div>
<script type="application/javascript" src='https://pink-spider.github.io/js/toc.js'></script>
<link rel="stylesheet" href='https://pink-spider.github.io/css/toc.css' />

<div id="gitalk-container" class="gitalk-container"></div>
<link rel="stylesheet" href='https://pink-spider.github.io/css/gitalk.css'>
<script src='https://pink-spider.github.io/js/gitalk.min.js'></script>
<script>
  const gitalk = new Gitalk({
    accessToken: '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',
    repo: 'pink-spider.github.io',
    owner: 'pink-spider',
    admin: ['pink-spider'],
    id: eval("location.pathname"), 
    distractionFreeMode: false 
  });
  (function() {
    gitalk.render('gitalk-container');
  })();
</script>


  <div class="footer container-xl width-full p-responsive">
  <div
    class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light"
  >
    <ul
      class="list-style-none d-flex flex-wrap col-12 flex-justify-center mb-2 mb-lg-0"
    >
      
    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>
</div>

</body>

<script type="application/javascript" src="https://pink-spider.github.io/js/github-style.js"></script>

<script src="https://pink-spider.github.io/js/mark.es6.min.js"></script>


<script type="text/javascript">

  const host = window.location.host;
  const keyword = localStorage.getItem('keyword');
  localStorage.removeItem('keyword');

  if (keyword) {
    const markInstance = new Mark(document.body);
    markInstance.unmark({
      done: function() {
        markInstance.mark(keyword);
      }
    });
  }

  const primaryColor = getComputedStyle(document.documentElement).getPropertyValue('--color-bg-primary');
  const mutedColor = getComputedStyle(document.documentElement).getPropertyValue('--color-fg-muted');
  const hoverColor = '#216EEB';

  let originalStyle;
  let svgOriginalStyle;
  let titleOriginalStyle;

  const onMouseOver = (node) => {
    originalStyle = Object.assign({}, node.style);
    node.style.backgroundColor = hoverColor;

    const child = node.querySelector('.js-jump');
    child.classList.remove('d-on-nav-focus');

    const title = node.querySelector('.title');
    if (title && primaryColor === ' #fff') {
      titleOriginalStyle = title.style;
      title.style.color = '#fff';
    }

    const svg = node.querySelector('.octicon');
    if (svg) {
      svgOriginalStyle = svg.style;
      svg.style.color = '#fff';
    }
  }

  const onMouseLeave = (node) => {
    node.style = originalStyle;
    const child = node.querySelector('.js-jump');
    child.classList.add('d-on-nav-focus');

    const title = node.querySelector('.title');
    title.style = titleOriginalStyle;

    const svg = node.querySelector('.octicon');
    svg.style = svgOriginalStyle;
  }

  const createSearchItem = (title, link, index) => {
    return `
    <li class="color-bg-primary search-item d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-scoped-search"
        role="option" aria-selected="false" tabindex="${index}">
        <a onmouseover="onMouseOver(this)" onmouseleave="onMouseLeave(this)"
          class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2"
          href="${link}" data-item-type="scoped_search">
          <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center ">
            <svg title="Repository" aria-label="Repository" role="img" height="16" viewBox="0 0 16 16"
              version="1.1" width="16" data-view-component="true"
              class="octicon octicon-repo js-jump-to-octicon-repo  flex-shrink-0">
              <path fill-rule="evenodd"
                d="M2 2.5A2.5 2.5 0 014.5 0h8.75a.75.75 0 01.75.75v12.5a.75.75 0 01-.75.75h-2.5a.75.75 0 110-1.5h1.75v-2h-8a1 1 0 00-.714 1.7.75.75 0 01-1.072 1.05A2.495 2.495 0 012 11.5v-9zm10.5-1V9h-8c-.356 0-.694.074-1 .208V2.5a1 1 0 011-1h8zM5 12.25v3.25a.25.25 0 00.4.2l1.45-1.087a.25.25 0 01.3 0L8.6 15.7a.25.25 0 00.4-.2v-3.25a.25.25 0 00-.25-.25h-3.5a.25.25 0 00-.25.25z">
              </path>
            </svg>
          </div>    

          <div
            class="title jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
            ${title}
          </div>

          <div aria-hidden="true" style="color: var(--color-fg-muted);"
            class="color-bg-primary js-jump border rounded-2 flex-shrink-0 color-bg-subtle px-1 ml-1 f6 d-on-nav-focus js-jump-to-badge-jump">
            Jump to
            <span class="d-inline-block ml-1 v-align-middle">↵</span>
          </div>
        </a>
      </li>
    `
  }

  const createGoogleSearchItem = (keyword) => {
    return `
    <li class="color-bg-primary search-item d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-scoped-search"
        role="option" aria-selected="false" tabindex="0">
        <a onmouseover="onMouseOver(this)" onmouseleave="onMouseLeave(this)"
          class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2"
          href="https://www.google.com/search?q=${keyword}" target="_blank" data-item-type="scoped_search">
          <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center ">
            <svg title="Search" aria-label="Search" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-search js-jump-to-octicon-search flex-shrink-0">
                <path fill-rule="evenodd" d="M11.5 7a4.499 4.499 0 11-8.998 0A4.499 4.499 0 0111.5 7zm-.82 4.74a6 6 0 111.06-1.06l3.04 3.04a.75.75 0 11-1.06 1.06l-3.04-3.04z"></path>
            </svg>
          </div>    

          <div
            class="title jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
            ${keyword}
          </div>

          <div aria-hidden="true" style="color: var(--color-fg-muted);"
            class="color-bg-primary js-jump border rounded-2 flex-shrink-0 color-bg-subtle px-1 ml-1 f6 d-on-nav-focus js-jump-to-badge-jump">
            Google search
            <span class="d-inline-block ml-1 v-align-middle">↵</span>
          </div>
        </a>
      </li>
    `
  }

  const stripHtml = (html) => {
    let tmp = document.createElement('div');
    tmp.innerHTML = html;

    
    const styles = tmp.getElementsByTagName('style');
    while(styles[0]) {
      styles[0].parentNode.removeChild(styles[0]);
    }

    
    const scripts = tmp.getElementsByTagName('script');
    while(scripts[0]) {
      scripts[0].parentNode.removeChild(scripts[0]);
    }
    
    return tmp.textContent || tmp.innerText || "";
  }

  const inputDom = document.querySelector(".Header-search-input");
  const resultDom = document.getElementById('jump-to-results');
  let debounceTimer;
  let parser;
  let xmlDoc;

  const search = (_keyword) => {

    resultDom.innerHTML = '';

    const keyword = _keyword;

    if (!keyword) return;

    const progressDom = document.getElementById('search-progress');
    if (progressDom && progressDom.classList.contains('d-none')) {
      progressDom.classList.remove('d-none');
    }

    localStorage.setItem('keyword', keyword);
    fetch(`${host.indexOf('localhost') > -1 ? 'http://' : 'https://'}${host}/index.xml`).then(resp => resp.text()).then(async (res) => {
      parser = new DOMParser();
      xmlDoc = parser.parseFromString(res, 'text/xml');
      const linkResult = xmlDoc.getElementsByTagName('link');
      const titleResult = xmlDoc.getElementsByTagName('title');
      const arr = [];

      const matched = [];
      await (async function searchLink() {
        for (let i = 0; i < linkResult.length; i++) {
          await fetch(linkResult[i].textContent).then(resp => resp.text().then(res => {
            const pureText = stripHtml(res);
            if (pureText.indexOf(keyword) >= 0) {
              matched.push(i);
            }
          }))
        }
      })();

      const googleSearchItem = createGoogleSearchItem(keyword);
      const node= document.createRange().createContextualFragment(googleSearchItem);
      resultDom.appendChild(node);

      matched.map((itemIndex, index) => {
        const r = createSearchItem(titleResult[itemIndex].textContent, linkResult[itemIndex].textContent, index + 1);
        const node = document.createRange().createContextualFragment(r);
        resultDom.appendChild(node);
      });

      if (progressDom && !progressDom.classList.contains('d-none')) {
        progressDom.classList.add('d-none');
      }
    });
  }

  const debounce = (callback, time) => {
    window.clearTimeout(debounceTimer);
    debounceTimer = window.setTimeout(callback, time);
  };

  ['focus', 'input'].forEach(event => {
    inputDom.addEventListener(event, (e) => {
      debounce(() => search(e.target.value), 500);
    }, false);
  });

  inputDom.addEventListener('blur', () => {
    setTimeout(() => {
      resultDom.innerHTML = '';
    }, 100);
  });

</script>






</html>